<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link as="style" href="https://fonts.googleapis.com/css2?display=swap&family=Lexend%3Awght%40400%3B500%3B600%3B700%3B800%3B900&family=Noto+Sans%3Awght%40400%3B500%3B700%3B900" onload="this.rel='stylesheet'" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
<title>FakeBreak, Gerçek mi Fake mi?</title>
<link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<style>
.material-icons, .material-icons-outlined { font-size: 28px; vertical-align: middle; }
.material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24; font-size: 24px; vertical-align: middle; }
.btn-primary { background-color: #5667F8; color: white; }
.btn-primary:hover { background-color: #4C5DF8; }
.btn-secondary { background-color: #E5E7EB; color: #1F2937; }
.btn-secondary:hover { background-color: #D1D5DB; }
.lexend-font { font-family: 'Lexend', "Noto Sans", sans-serif; }
.card-gradient { background-image: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.7) 60%, rgba(0, 0, 0, 0.9) 100%); }
.primary-color-text { color: #5667F8; }
.primary-color-bg { background-color: #5667F8; }
.news-button-disabled { opacity: 0.6; pointer-events: none; }
.correct-feedback { background-color: #EBF9F0; border-left: 4px solid #34D399; }
.incorrect-feedback { background-color: #FEE2E2; border-left: 4px solid #F87171; }
.status-icon-correct { color: #34D399; }
.status-icon-incorrect { color: #F87171; }
.timeup-icon { color: #F59E0B; }

#appRoot { overflow-y: hidden; }
body.loading #appRoot > .main-screen-view { opacity: 0; transform: scale(0.98); transition: none !important; }
.main-screen-view { opacity: 1; transform: translateY(0) scale(1); transition: opacity 0.4s ease-out, transform 0.4s ease-out; }
.main-screen-view.hidden { opacity: 0 !important; transform: scale(0.98) !important; pointer-events: none; display: none !important; }

.nav-item-active span.nav-icon { color: #5667F8; transform: scale(1.1); }
.nav-item-active span.nav-text { color: #5667F8; font-weight: 600; }
.btn-animated { transition: transform 0.1s ease-in-out, background-color 0.1s; }
.btn-animated:active { transform: scale(0.96); }
.feedback-content-appear { animation: scaleUpSpring 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes scaleUpSpring { from { opacity: 0; transform: scale(0.7); } to { opacity: 1; transform: scale(1); } }

.timer-pulse { animation: pulseTimerWarn 1s infinite ease-in-out; }
@keyframes pulseTimerWarn { 0%, 100% { transform: scale(1); color: inherit; } 50% { transform: scale(1.15); color: #ef4444; } }

.timer-box-pulse { animation: pulseTimerBoxWarn 1s infinite ease-in-out; }
@keyframes pulseTimerBoxWarn {
  0%, 100% { background-color: #E5E7EB; /* slate-200, original timer box bg */ }
  50% { background-color: #FEE2E2; /* red-100 */ }
}


#newsCardContainer { position: relative; width: 100%; max-width: calc(100% - 2rem); margin-left: auto; margin-right: auto; aspect-ratio: 3 / 4; min-height: 380px; sm:min-height: 450px; overflow: visible; }
#newsCard { position: absolute; top: 0; left: 0; right: 0; bottom: 0; cursor: grab; user-select: none; touch-action: pan-y; transition: transform 0.3s ease-out; will-change: transform, opacity; background-color: #f3f4f6; border-radius: 1rem; overflow:hidden; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1); }
#newsCard.swiping { cursor: grabbing; transition: none; }
.swipe-decision-indicator { position: absolute; top: 30px; padding: 0.5rem 1rem; border-radius: 0.5rem; font-size: 1.25rem; font-weight: 700; color: white; border: 2px solid rgba(255,255,255,0.8); opacity: 0; transform: rotate(-15deg) scale(0.8); transition: opacity 0.3s ease-out, transform 0.3s ease-out; z-index: 10; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
.swipe-decision-indicator.real-indicator { background-color: rgba(5, 150, 105, 0.9); left: 30px; transform: rotate(-25deg) scale(0.8); }
.swipe-decision-indicator.fake-indicator { background-color: rgba(220, 38, 38, 0.9); right: 30px; transform: rotate(25deg) scale(0.8); }
.swipe-decision-indicator.visible { opacity: 1; transform: rotate(-15deg) scale(1.1); }
.swipe-decision-indicator.fake-indicator.visible { transform: rotate(15deg) scale(1.1); }

@keyframes cardFlyOutLeftAnim { 0% { transform: translateX(0) rotate(0deg) scale(1); opacity: 1; } 100% { transform: translateX(-130vw) rotate(-40deg) scale(0.7); opacity: 0; } }
@keyframes cardFlyOutRightAnim { 0% { transform: translateX(0) rotate(0deg) scale(1); opacity: 1; } 100% { transform: translateX(130vw) rotate(40deg) scale(0.7); opacity: 0; } }
#newsCard.fly-out-left { animation: cardFlyOutLeftAnim 0.4s cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards; }
#newsCard.fly-out-right { animation: cardFlyOutRightAnim 0.4s cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards; }

@keyframes cardEnterAnim { to { transform: translateY(0) scale(1) rotateX(0deg); opacity: 1; } }
#newsCard.enter-anim { visibility: hidden; opacity: 0; transform: translateY(60px) scale(0.95) rotateX(-15deg); }
#newsCard.enter-anim.active { visibility: visible; animation: cardEnterAnim 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }

.modal-backdrop { background-color: rgba(30, 41, 59, 0.7); backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px); }

/* SPONSORLU KART STİLLERİ */
.sponsored-news-card {
    border: 3px solid #FFBF00; /* Canlı altın sarısı kenarlık */
}

.sponsored-badge {
    display: none; /* Varsayılan olarak gizli */
    background-color: rgba(255, 191, 0, 0.95); /* Altın sarısı arka plan */
    color: #1F2937; /* Koyu gri (Tailwind slate-800) */
    padding: 3px 8px;
    border-radius: 0.375rem; /* Tailwind rounded-md */
    font-size: 0.6rem;  /* Çok küçük */
    font-weight: 700;   /* Kalın */
    text-transform: uppercase;
    align-self: flex-start; /* Metin bloğunun başında sola yaslı */
    line-height: 1; /* Dikey hizalamayı iyileştirmek için */
}

.sponsored-news-card .sponsored-badge {
    display: inline-block; /* Sponsorlu kartlarda görünür yap */
}
/* SPONSORLU KART STİLLERİ BİTİŞ */

html, body {
  height: 100%;
  overflow: hidden;
  margin: 0;
  padding: 0;
}

/* Editöre Sor Butonu Stilleri */
#askEditorBtn {
    background-color: #F43F5E; /* Tailwind rose-500 */
    color: white;
    padding: 0.5rem 0.75rem; /* sm:px-3 sm:py-2 */
    border-radius: 0.5rem; /* Tailwind rounded-lg */
    font-weight: 600; /* Tailwind font-semibold */
    font-size: 0.875rem; /* Tailwind text-sm */
    display: flex;
    align-items: center;
    gap: 0.375rem; /* Tailwind gap-1.5 */
    transition: background-color 0.2s ease-in-out, opacity 0.2s ease-in-out, transform 0.1s ease-in-out;
}
#askEditorBtn:hover:not(.disabled) { /* Sadece aktifken hover rengi değişsin */
    background-color: #E11D48; /* Tailwind rose-600 */
}
#askEditorBtn:active:not(.disabled) { /* Sadece aktifken active ölçeği */
    transform: scale(0.96);
}
#askEditorBtn.disabled {
    background-color: #9CA3AF; /* Tailwind gray-400 */
    color: #E5E7EB; /* Tailwind gray-200 */
    cursor: not-allowed;
    opacity: 0.7;
}
#askEditorBtn.disabled .material-icons-outlined {
    color: #D1D5DB; /* Tailwind gray-300 */
}


/* Editör İpucu Modalı Stilleri */
#editorHintModal {
    background-color: rgba(30, 41, 59, 0.85); /* Koyu backdrop */
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
}
.editor-hint-content {
    background-color: #1F2937; /* Tailwind slate-800 */
    color: #F3F4F6; /* Tailwind slate-100 */
    border-radius: 0.75rem; /* Tailwind rounded-xl */
    padding: 1.5rem; /* Tailwind p-6 */
    box-shadow: 0 20px 25px -5px rgba(0,0,0,0.2), 0 10px 10px -5px rgba(0,0,0,0.1);
    max-width: 360px; /* sm:max-w-sm */
    width: calc(100% - 2rem);
}
.editor-icon-container {
    width: 72px; /* Tailwind w-18 */
    height: 72px; /* Tailwind h-18 */
    border-radius: 50%;
    background-color: #4B5563; /* Tailwind gray-600 */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    border: 3px solid #D1D5DB; /* Tailwind gray-300 */
    margin-bottom: 1rem; /* Tailwind mb-4 */
}
.editor-icon-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.editor-name {
    font-size: 1.25rem; /* Tailwind text-xl */
    font-weight: 700; /* Tailwind font-bold */
    color: #E5E7EB; /* Tailwind gray-200 */
    margin-bottom: 0.5rem; /* Tailwind mb-2 */
}
.editor-quote {
    font-size: 0.95rem; /* Tailwind text-base ayarı gibi */
    line-height: 1.6; /* Tailwind leading-relaxed */
    color: #D1D5DB; /* Tailwind gray-300 */
    min-height: 60px; /* Metin için minimum yükseklik */
}
.editor-quote::after {
    content: '▍';
    animation: typing-cursor 0.7s infinite;
    display: inline-block;
    opacity: 1;
}
.editor-quote.typing-done::after {
    display: none;
}

@keyframes typing-cursor {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}
#closeEditorHintBtn {
    background-color: #374151; /* Tailwind gray-700 */
    color: #D1D5DB; /* Tailwind gray-300 */
    border-radius: 9999px; /* Tailwind rounded-full */
    padding: 0.5rem; /* Tailwind p-2 */
}
#closeEditorHintBtn:hover {
    background-color: #4B5563; /* Tailwind gray-600 */
}
</style>
</head>
<body class="bg-slate-100 lexend-font loading">

<div id="unsupportedDeviceOverlay" style="display: none; position: fixed; inset: 0; background-color: rgba(30, 41, 59, 0.95); color: white; flex-direction: column; align-items: center; justify-content: center; text-align: center; z-index: 9999; font-family: 'Lexend', sans-serif; padding: 20px;">
    <span class="material-icons" style="font-size: 64px; margin-bottom: 20px;">stay_primary_portrait</span>
    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: -8px;">Yok artık, masaüstünden mi girdin?!😏</h2>
  <p style="font-size: 18px;">Bu oyun koca koca ekranlara değil, minnoş mobil cihazlara göre yapıldı!</p>
</div>

<div id="appRoot" class="relative flex size-full flex-col group/design-root overflow-x-hidden">

<div id="homeScreen" class="main-screen-view flex flex-col h-full">
<header id="homeHeader" class="bg-white shadow-md sticky top-0 z-20">
<div class="container mx-auto px-4 py-3 flex items-center justify-between">
  <div class="w-7 h-7 flex justify-start items-center">
    <img src="https://i.ibb.co/hRJ4WqKc/Group-8695.png" alt="FakeBreak Logo" class="max-w-full max-h-full object-contain">
  </div>
  <h1 class="text-xl font-bold text-slate-800 text-center flex-1">FakeBreak</h1>
  <div class="w-10 flex justify-end items-center">
    <button id="aboutBtn" class="flex items-center justify-center rounded-full h-10 w-10 text-slate-600 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-[#5667F8] focus:ring-opacity-50 btn-animated">
      <span class="material-icons">info_outline</span>
    </button>
  </div>
</div>
</header>
<main id="homeMain" class="flex-grow container mx-auto px-6 py-8 text-center overflow-y-auto">
<div class="max-w-md mx-auto">
<img alt="FakeBreak Uygulama İkonu" class="w-24 h-24 mx-auto mb-6 rounded-2xl shadow-xl" src="https://lh3.googleusercontent.com/aida-public/AB6AXuA-fyUmZiKE_nHNvrPBkaFU8b7xUACLQqHF6tcg8JvnK5Q6c6jPl3YmzTHiKo_1obIExV7JX4I7-RwqTrwTlDjr3jOk6evMGA_LsZZJqffZTDzErZ_HID38KBy94n4llusld-zy1HQGA6Vh60LEgx5n42La1umYxi6ix0kaC2sMngn_puvstBZscr-hOff8pSDIQZ6mr68JnYKwqbxfEF-BKh-Ra7riGUwcTQ9ACW7YYGk29y9OHCMUBDyMu4TRx8h8D9O5pafdDLfV"/>
<h2 class="text-3xl sm:text-4xl font-bold text-slate-800 mb-3">Gerçek Bir Gündem Kurdu musun?</h2>
<p class="text-lg sm:text-xl text-slate-600 mb-10">Öyleyse hodri meydan! "Bu kadar da olmaz!" dediğin anlar olacak, eminiz. Ama acaba hangisi gerçek, hangisi aldatmaca?</p>
<div class="space-y-4">
<button id="playNowBtn" class="btn-primary btn-animated w-full flex items-center justify-center rounded-xl h-14 px-6 text-lg font-semibold shadow-lg hover:shadow-xl focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#5667F8] transition-all duration-150">
<span class="material-icons mr-2 nav-icon">play_arrow</span>Hemen Oyna
</button>
<button id="leaderboardBtnHome" class="btn-secondary btn-animated w-full flex items-center justify-center rounded-xl h-14 px-6 text-lg font-semibold shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 transition-all duration-150">
<span class="material-icons-outlined mr-2 nav-icon">leaderboard</span>Skorları Gör
</button>
<button id="howToPlayBtn" class="btn-secondary btn-animated w-full flex items-center justify-center rounded-xl h-14 px-6 text-lg font-semibold shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 transition-all duration-150">
<span class="material-icons-outlined mr-2 nav-icon">help_outline</span>Nasıl Oynanır?
</button>
</div>
</div>
</main>
<footer id="homeFooter" class="bg-white border-t border-slate-200 sticky bottom-0 z-20 shadow-top">
<nav class="container mx-auto px-4 h-16 flex justify-around items-center">
<a id="homeNavHome" href="#" class="flex-1 flex flex-col items-center justify-center text-slate-500 hover:text-[#5667F8] hover:bg-slate-100 transition-all duration-150 p-2 rounded-lg nav-link">
<span class="material-icons-outlined nav-icon">home</span><span class="text-xs font-medium nav-text">Ana Sayfa</span>
</a>
<a id="homeNavScores" href="#" class="flex-1 flex flex-col items-center justify-center text-slate-500 hover:text-[#5667F8] hover:bg-slate-100 transition-all duration-150 p-2 rounded-lg nav-link">
<span class="material-icons-outlined nav-icon">bar_chart</span><span class="text-xs font-medium nav-text">Skorlar</span>
</a>
<a id="homeNavProfile" href="#" class="flex-1 flex flex-col items-center justify-center text-slate-500 hover:text-[#5667F8] hover:bg-slate-100 transition-all duration-150 p-2 rounded-lg nav-link">
<span class="material-icons-outlined nav-icon">person_outline</span><span class="text-xs font-medium nav-text">Profil</span>
</a>
</nav>
</footer>
</div>

<div id="gameScreen" class="main-screen-view hidden flex-col h-full">
<div class="relative flex size-full flex-col bg-slate-50 group/design-root overflow-x-hidden lexend-font">
<header class="sticky top-0 z-20 bg-white shadow-md">
<div class="flex items-center p-4 pb-3 justify-between">
  <button id="closeGameBtn" class="text-gray-700 flex size-10 shrink-0 items-center justify-center rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#5667F8] btn-animated transition-colors duration-150">
    <span class="material-icons-outlined">close</span>
  </button>
  <h1 class="text-gray-900 text-xl font-semibold leading-tight tracking-tight text-center">Gerçek mi Sahte mi?</h1>
  <div class="size-10"></div>
</div>
<div class="px-4 pb-3">
<div class="flex items-center justify-between mb-1.5">
<p class="text-gray-700 text-sm font-medium">Soru <span id="currentQuestionDisplay" class="font-bold text-gray-900">1</span>/<span id="totalQuestionsDisplay">7</span></p>
<div class="flex items-center gap-3">
<p class="text-gray-700 text-sm font-medium">Skor: <span id="scoreDisplay" class="font-bold text-gray-900">0</span></p>
<p class="text-gray-700 text-sm font-medium">Seri: <span id="streakCounter" class="font-bold text-gray-900">0</span> 🔥</p>
</div>
</div>
<div class="h-3 rounded-full bg-gray-300">
<div id="progressBar" class="h-3 rounded-full primary-color-bg transition-all duration-300 ease-out" style="width: 0%;"></div>
</div>
</div>
</header>
<main class="flex-1 overflow-y-auto p-4 flex flex-col items-center justify-start space-y-3 sm:space-y-4">
    <div class="flex w-full items-center justify-center gap-16 sm:gap-6 px-1 sm:px-2 my-3 sm:my-4">
        <div class="flex gap-2 sm:gap-3 items-center">
            <div class="flex flex-col items-center gap-1">
                <div id="timerMinutesBox" class="flex h-10 w-10 sm:h-12 sm:w-12 items-center justify-center rounded-lg bg-slate-200 shadow-inner">
                    <p id="timerMinutes" class="text-gray-900 text-lg sm:text-xl font-bold">00</p>
                </div>
                <p class="text-gray-600 text-[10px] sm:text-xs font-medium">Dakika</p>
            </div>
            <div class="flex items-center text-gray-400 text-lg sm:text-xl font-bold pt-1 pb-4 sm:pb-5">:</div>
            <div class="flex flex-col items-center gap-1">
                <div id="timerSecondsBox" class="flex h-10 w-10 sm:h-12 sm:w-12 items-center justify-center rounded-lg bg-slate-200 shadow-inner">
                    <p id="timerSeconds" class="text-gray-900 text-lg sm:text-xl font-bold">15</p>
                </div>
                <p class="text-gray-600 text-[10px] sm:text-xs font-medium">Saniye</p>
            </div>
        </div>
        <button id="askEditorBtn" class="btn-animated">
            <span class="material-icons-outlined text-lg mr-1">support_agent</span>
            <span id="askEditorBtnText">Editöre Sor</span>
        </button>
    </div>

<div id="newsCardContainer" class="relative w-full max-w-sm sm:max-w-md aspect-[3/4] rounded-2xl shadow-2xl">
<div id="swipeRealIndicator" class="swipe-decision-indicator real-indicator">GERÇEK</div>
<div id="swipeFakeIndicator" class="swipe-decision-indicator fake-indicator">SAHTE</div>
<div id="newsCard" class="absolute inset-0 rounded-2xl overflow-hidden bg-slate-200">
    <img id="newsImage" alt="Haber Makalesi Resmi" class="absolute inset-0 h-full w-full object-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async"/>
    <div class="absolute inset-0 card-gradient flex flex-col justify-end p-3 sm:p-5 space-y-1 sm:space-y-2">
        <span class="sponsored-badge">SPONSORLU</span>
        <h2 id="newsTitle" class="text-white text-xl sm:text-2xl font-bold leading-tight drop-shadow-lg">Haber Başlığı</h2>
        <p id="newsSnippet" class="text-gray-200 text-xs sm:text-sm font-normal leading-relaxed line-clamp-3 sm:line-clamp-4 drop-shadow-md">Haber metni...</p>
    </div>
</div>
</div>
<div class="text-center text-slate-500/80 mt-3 text-xs sm:text-sm px-4">
Karar vermek için haber kartını <strong>sağa (GERÇEK)</strong> veya <strong>sola (SAHTE)</strong> doğru kaydırın.
</div>
</main>
<nav class="sticky bottom-0 bg-white border-t border-gray-200 pb-safe z-20 shadow-top">
<div class="flex justify-around items-center h-16">
<a id="gameNavHome" href="#" class="nav-link flex flex-col items-center justify-center gap-0.5 text-gray-500 hover:primary-color-text hover:bg-gray-100 transition-all duration-150 w-1/3 p-2 rounded-lg">
<span class="material-icons-outlined nav-icon text-2xl">cottage</span><span class="text-xs font-medium nav-text">Ana Sayfa</span>
</a>
<a id="gameNavGame" href="#" class="nav-link flex flex-col items-center justify-center gap-0.5 text-gray-500 hover:primary-color-text hover:bg-gray-100 transition-all duration-150 w-1/3 p-2 rounded-lg">
<span class="material-icons-outlined nav-icon text-2xl">gamepad</span><span class="text-xs font-medium nav-text">Oyun</span>
</a>
<a id="gameNavScores" href="#" class="nav-link flex flex-col items-center justify-center gap-0.5 text-gray-500 hover:primary-color-text hover:bg-gray-100 transition-all duration-150 w-1/3 p-2 rounded-lg">
<span class="material-icons-outlined nav-icon text-2xl">leaderboard</span><span class="text-xs font-medium nav-text">Skorlar</span>
</a>
</div>
</nav>
</div>
</div>

<div id="howToPlayModal" class="fixed inset-0 items-center justify-center p-4 hidden z-50 modal-backdrop">
<div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-auto feedback-content-appear">
<div class="flex justify-between items-center mb-4">
<h3 class="text-2xl font-bold text-slate-800 lexend-font">Nasıl Oynanır?</h3>
<button id="closeModalBtn" class="text-slate-500 hover:text-slate-700 btn-animated p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#5667F8] transition-colors duration-150">
<span class="material-icons">close</span>
</button>
</div>
<div class="text-slate-600 space-y-3 lexend-font">
<p>FakeBreak'e hoş geldiniz!</p>
<p>1. Ekranda beliren haber kartını dikkatlice okuyun.</p>
<p>2. Haberin <strong>GERÇEK</strong> olduğuna inanıyorsanız kartı <strong>SAĞA</strong> doğru kaydırın.</p>
<p>3. Haberin <strong>SAHTE</strong> olduğuna inanıyorsanız kartı <strong>SOLA</strong> doğru kaydırın.</p>
<p>4. Kafan karıştığında <strong class="text-rose-500">"Editöre Sor"</strong> butonuna basarak bir ipucu alabilirsin (her soruda bir kere!).</p>
<p>Haber okuryazarlığınızı test edin ve ne kadar yüksek puan alabileceğinizi görün!</p>
</div>
</div>
</div>

<div id="aboutModal" class="fixed inset-0 items-center justify-center p-4 hidden z-50 modal-backdrop">
<div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-auto feedback-content-appear">
<div class="flex justify-between items-center mb-4">
  <h3 class="text-2xl font-bold text-slate-800 lexend-font">Hakkında</h3>
  <button id="closeAboutModalBtn" class="text-slate-500 hover:text-slate-700 btn-animated p-1 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#5667F8] transition-colors duration-150">
    <span class="material-icons">close</span>
  </button>
</div>
<div class="text-slate-600 space-y-3 lexend-font">
    <p>Her gün sadece bizim coğrafyada olabileceğine inandığımız, “bu da ancak burada olur” dedirten olaylarla karşılaşıyoruz. İşte bu oyun, ülkemizin kendine has gündemini, bitmek bilmeyen sürprizlerini ve eşsiz mizah anlayışını yansıtmak amacıyla tamamen eğlence için geliştirilmiştir.</p>
    <p>Geliştirici: Gemini + ChatGPT</p>
    <p class="text-sm text-slate-500">(Konsept & Prompt Whisperer: Emre Öcal)</p>
</div>
</div>
</div>

<div id="profileDisabledPopup" class="fixed bottom-[15%] left-1/2 transform -translate-x-1/2 bg-slate-800 text-white text-sm py-2.5 px-5 sm:py-3 sm:px-6 rounded-lg shadow-xl z-[100] opacity-0 transition-all duration-300 ease-out pointer-events-none">
    Boşuna basma, işlevi yok. Dolu gözüksün diye koydum 😎
</div>

<div id="timeUpPopup" class="fixed inset-0 items-center justify-center p-4 hidden z-40 modal-backdrop">
<div class="bg-white rounded-lg shadow-xl p-6 sm:p-8 max-w-xs sm:max-w-sm w-full text-center feedback-content-appear">
<span class="material-icons-outlined timeup-icon mb-4" style="font-size: 48px;">timer_off</span>
<h3 class="text-xl sm:text-2xl font-bold text-slate-800 mb-3">Süren Doldu!</h3>
<p class="text-slate-600 mb-6 text-sm sm:text-base">Bu soru için cevap süreniz sona erdi.</p>
<button id="timeUpOkButton" class="w-full rounded-full h-11 px-6 btn-primary hover:bg-[#4C5DF8] text-lg font-semibold transition-colors btn-animated focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#5667F8]">Tamam</button>
</div>
</div>

<div id="feedbackScreen" class="main-screen-view hidden bg-slate-100 fixed inset-0 z-30 flex flex-col justify-between overflow-y-auto h-full">
<header class="sticky top-0 z-10 bg-white shadow-sm"> <div class="mx-auto flex max-w-3xl items-center justify-end p-3 sm:p-4"> <button id="closeFeedbackBtn" class="flex items-center justify-center rounded-full text-slate-700 hover:bg-slate-100 p-2 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 btn-animated transition-colors duration-150"> <span class="material-icons-outlined">close</span> </button> </div> </header> <main class="flex-grow px-4 sm:px-6 py-6 sm:py-8"> <div class="mx-auto max-w-md text-center feedback-content-appear"> <div class="mb-6 sm:mb-8"> <span id="feedbackIcon" class="material-icons-outlined" style="font-size: 56px sm:font-size: 64px;"></span> <h2 id="feedbackTitle" class="mt-3 sm:mt-4 text-2xl sm:text-3xl font-bold text-slate-800"></h2> </div> <div id="feedbackBox" class="rounded-lg bg-white p-5 sm:p-6 shadow-xl mb-6 sm:mb-8"> <p id="feedbackText" class="text-slate-700 text-sm sm:text-base leading-relaxed"></p> </div> <div id="feedbackSourceSection" class="hidden rounded-lg bg-white p-5 sm:p-6 shadow-xl text-left"> <h3 class="text-lg sm:text-xl font-semibold text-slate-800 mb-3">Kaynak İncelemesi</h3> <a id="feedbackSourceLinkTag" class="flex items-center gap-3 text-slate-600 hover:text-blue-600 transition-colors group" href="#" target="_blank" rel="noopener noreferrer"> <div class="flex items-center justify-center rounded-lg bg-slate-100 group-hover:bg-blue-100 p-3 shrink-0 transition-colors"> <span class="material-icons-outlined text-slate-500 group-hover:text-blue-600">link</span> </div> <p id="feedbackSourceName" class="text-sm sm:text-base font-medium flex-1 truncate"></p> <span class="material-icons-outlined text-slate-400 group-hover:text-blue-500 text-lg">arrow_forward_ios</span> </a> </div> </div> </main> <footer class="sticky bottom-0 bg-white border-t border-slate-200 p-4 shadow-top"> <div class="mx-auto max-w-md"> <button id="feedbackNextButton" class="w-full flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-12 px-6 btn-primary text-white text-lg font-semibold leading-normal tracking-[0.015em] hover:bg-[#4C5DF8] transition-colors focus:outline-none focus:ring-2 focus:ring-[#5667F8] focus:ring-offset-2 btn-animated"> <span class="truncate">Sonraki Soru</span> </button> </div> </footer>
</div>

<div id="resultsScreen" class="main-screen-view hidden bg-slate-100 fixed inset-0 z-30 flex flex-col justify-between overflow-y-auto h-full"> <header class="sticky top-0 z-10 bg-white shadow-sm"> <div class="mx-auto flex max-w-7xl items-center justify-between p-4"> <button id="closeResultsHeaderBtn" class="text-slate-700 hover:text-slate-900 p-2 rounded-full btn-animated focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#5667F8] transition-colors duration-150"> <span class="material-symbols-outlined">close</span> </button> <h1 class="text-xl font-semibold text-slate-900">Sonuçlar</h1> <div class="w-8 sm:w-10"></div> </div> </header> <main class="flex-1 overflow-y-auto px-6 py-8"> <div class="mx-auto max-w-md text-center"> <div class="mb-8 rounded-xl bg-white p-6 shadow-xl feedback-content-appear"> <h2 class="text-4xl sm:text-5xl font-bold text-slate-800">Skorun: <span id="finalScoreValue" class="text-[#5667F8]">0/0</span></h2> <p class="mt-2 text-slate-600">En Yüksek Skor: <span id="highScoreDisplay" class="font-medium text-slate-700">0/0</span></p> <p class="mt-1 text-slate-600">Harcanan Süre: <span id="timeTakenValue" class="font-medium text-slate-700">0 dakika 0 saniye</span></p>
<h4 class="text-lg font-semibold text-slate-700 mt-6 mb-3 hidden">Başarımlar</h4>
<div id="achievementsDisplay" class="space-y-2 hidden"> </div>
</div> <div class="rounded-xl bg-white p-6 shadow-xl mt-8"> <div class="flex items-center justify-between mb-6"> <h3 class="text-2xl font-semibold text-slate-800">Liderlik Tablosu</h3> <span class="material-symbols-outlined text-yellow-500 !text-3xl">emoji_events</span> </div> <div id="leaderboardEntriesContainer" class="space-y-3"> </div> </div> </div> </main>
<footer class="sticky bottom-0 bg-white/90 backdrop-blur-sm p-4 shadow-[0_-2px_10px_rgba(0,0,0,0.08)]">
  <div class="mx-auto flex max-w-md flex-col gap-3">
    <button id="shareResultsBtn" class="flex h-12 w-full items-center justify-center rounded-full bg-[#27AE60] px-5 text-base font-bold text-white tracking-wide shadow-md hover:bg-[#219653] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#27AE60] btn-animated transition-colors duration-150">
        <span class="material-symbols-outlined mr-2">share</span>Sonucu Paylaş
    </button>
    <button id="playAgainBtn" class="flex h-12 w-full items-center justify-center rounded-full bg-[#E0E7FF] px-5 text-base font-bold text-[#3730A3] tracking-wide shadow-md hover:bg-[#C7D2FE] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#A5B4FC] btn-animated transition-colors duration-150">
        <span class="material-symbols-outlined mr-2">replay</span>Tekrar Oyna
    </button>
    <button id="backToHomeResultsBtn" class="flex h-12 w-full items-center justify-center rounded-full bg-slate-200 px-5 text-base font-bold text-slate-700 tracking-wide shadow-md hover:bg-slate-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 btn-animated transition-colors duration-150">
        <span class="material-symbols-outlined mr-2">home</span>Ana Sayfaya Dön
    </button>
  </div>
</footer>
</div>

<div id="editorHintModal" class="fixed inset-0 items-center justify-center p-4 hidden z-[60]">
    <div class="editor-hint-content feedback-content-appear text-center">
        <div class="flex justify-end mb-2">
             <button id="closeEditorHintBtn" class="btn-animated">
                <span class="material-icons">close</span>
            </button>
        </div>
        <div class="editor-icon-container mx-auto">
            <img id="editorIcon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="Editör İkonu">
        </div>
        <h3 id="editorName" class="editor-name">Editör Adı</h3>
        <p id="editorQuote" class="editor-quote"></p>
    </div>
</div>

</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
const appRoot = document.getElementById('appRoot');
const unsupportedDeviceOverlay = document.getElementById('unsupportedDeviceOverlay');
const homeScreenDiv = document.getElementById('homeScreen');
const playNowButton = document.getElementById('playNowBtn');
const howToPlayButton = document.getElementById('howToPlayBtn');
const leaderboardBtnHome = document.getElementById('leaderboardBtnHome');
const modal = document.getElementById('howToPlayModal');
const closeModalButton = document.getElementById('closeModalBtn');
const aboutBtn = document.getElementById('aboutBtn');
const aboutModal = document.getElementById('aboutModal');
const closeAboutModalBtn = document.getElementById('closeAboutModalBtn');
const gameScreenDiv = document.getElementById('gameScreen');
const closeGameButton = document.getElementById('closeGameBtn');
const currentQuestionDisplay = document.getElementById('currentQuestionDisplay');
const totalQuestionsDisplay = document.getElementById('totalQuestionsDisplay');
const scoreDisplay = document.getElementById('scoreDisplay');
const streakCounter = document.getElementById('streakCounter');
const progressBar = document.getElementById('progressBar');
const timerMinutes = document.getElementById('timerMinutes');
const timerSeconds = document.getElementById('timerSeconds');
const timerMinutesBox = document.getElementById('timerMinutesBox');
const timerSecondsBox = document.getElementById('timerSecondsBox');
const newsCardContainer = document.getElementById('newsCardContainer');
const newsCard = document.getElementById('newsCard');
const newsImage = document.getElementById('newsImage');
const newsTitle = document.getElementById('newsTitle');
const newsSnippet = document.getElementById('newsSnippet');
const swipeRealIndicator = document.getElementById('swipeRealIndicator');
const swipeFakeIndicator = document.getElementById('swipeFakeIndicator');
const timeUpPopup = document.getElementById('timeUpPopup');
const timeUpOkButton = document.getElementById('timeUpOkButton');
const feedbackScreen = document.getElementById('feedbackScreen');
const closeFeedbackBtn = document.getElementById('closeFeedbackBtn');
const feedbackIcon = document.getElementById('feedbackIcon');
const feedbackTitleElement = document.getElementById('feedbackTitle');
const feedbackBox = document.getElementById('feedbackBox');
const feedbackText = document.getElementById('feedbackText');
const feedbackSourceSection = document.getElementById('feedbackSourceSection');
const feedbackSourceLinkTag = document.getElementById('feedbackSourceLinkTag');
const feedbackSourceName = document.getElementById('feedbackSourceName');
const feedbackNextButton = document.getElementById('feedbackNextButton');
const resultsScreen = document.getElementById('resultsScreen');
const finalScoreValue = document.getElementById('finalScoreValue');
const highScoreDisplay = document.getElementById('highScoreDisplay');
const timeTakenValue = document.getElementById('timeTakenValue');
const leaderboardEntriesContainer = document.getElementById('leaderboardEntriesContainer');
const playAgainBtn = document.getElementById('playAgainBtn');
const backToHomeResultsBtn = document.getElementById('backToHomeResultsBtn');
const closeResultsHeaderBtn = document.getElementById('closeResultsHeaderBtn');
const shareResultsBtn = document.getElementById('shareResultsBtn');
const homeNavHome = document.getElementById('homeNavHome');
const homeNavScores = document.getElementById('homeNavScores');
const homeNavProfile = document.getElementById('homeNavProfile');
const gameNavHome = document.getElementById('gameNavHome');
const gameNavGame = document.getElementById('gameNavGame');
const gameNavScores = document.getElementById('gameNavScores');
const profileDisabledPopup = document.getElementById('profileDisabledPopup');

// Editör İpucu Elementleri
const askEditorBtn = document.getElementById('askEditorBtn');
const askEditorBtnText = document.getElementById('askEditorBtnText');
const editorHintModal = document.getElementById('editorHintModal');
const closeEditorHintBtn = document.getElementById('closeEditorHintBtn');
const editorIcon = document.getElementById('editorIcon');
const editorName = document.getElementById('editorName');
const editorQuote = document.getElementById('editorQuote');


if (!appRoot || !unsupportedDeviceOverlay || !homeScreenDiv || !gameScreenDiv || !newsCard || !newsCardContainer || !modal || !timeUpPopup || !feedbackScreen || !resultsScreen || !aboutModal || !profileDisabledPopup || !newsTitle || !feedbackTitleElement || !timerMinutesBox || !timerSecondsBox || !askEditorBtn || !editorHintModal || !closeEditorHintBtn || !editorIcon || !editorName || !editorQuote || !askEditorBtnText ) {
console.error("Kritik HTML elementlerinden biri veya birkaçı DOM'da bulunamadı! Lütfen ID'leri kontrol edin.");
if(document.body) document.body.innerHTML = "<p style='color:red; text-align:center; font-size:20px; margin-top:50px;'>Kritik bir hata oluştu. Lütfen geliştirici konsolunu kontrol edin.</p>";
return;
}

function checkScreenSize() {
    const MAX_SUPPORTED_WIDTH = 768;
    if (window.innerWidth > MAX_SUPPORTED_WIDTH) {
        unsupportedDeviceOverlay.style.display = 'flex';
        appRoot.style.display = 'none';
    } else {
        unsupportedDeviceOverlay.style.display = 'none';
        appRoot.style.display = 'flex';
    }
}
checkScreenSize();
window.addEventListener('resize', checkScreenSize);


const newsData = [
{id: 1, title: "Düğün konvoyunun yolunu İHA ile kestiler!", snippet: "Sakarya’nın Arifiye ilçesinde TEKNOFEST’e hazırlanan üniversiteli gençler, geliştirdikleri İnsansız Hava Aracı (İHA) ile sıra dışı bir geleneğe imza attı.", image: "https://i.ibb.co/2YZS2NvT/image.png", link: "https://www.milliyet.com.tr/gundem/dugun-konvoyunu-iha-ile-kestiler-boyle-yol-kesme-gelenegi-gorulmedi-7377522", isReal: true, explanation: "Valla gerçek! Sakarya'da üniversiteli gençler TEKNOFEST için yaptıkları İHA ile 'Durun bakalım, önce bizim bahşiş!' demişler resmen. Teknoloji ve gelenek böyle de birleşiyormuş demek ki, helal olsun gençlerimize.", displaySourceName: "Milliyet", displaySourceLink: "https://www.milliyet.com.tr/gundem/dugun-konvoyunu-iha-ile-kestiler-boyle-yol-kesme-gelenegi-gorulmedi-7377522", isSponsored: false, editorHint: "Teknoloji bazen geleneklerle birleşince şaşırtıcı şeyler olabiliyor, özellikle gençlerin eli değince... Acaba bu da onlardan biri mi?"},
{id: 2, title: "Bursalı işletmeci Etiyopya'lı kabileye kebabı sevdirdi!", snippet: "Keçiden Adana yapınca kabile ayağa kalktı, o günden beri herkes ona “enişte” diyor.", image: "https://i.ibb.co/mVmKVnC0/Screenshot-2025-05-25-at-16-12-45.png", link: "https://www.milliyet.com.tr/pembenar/etiyopyali-kabileye-kebabi-sevdiren-bursali-bana-herkes-burada-eniste-diyor-7368262", isReal: true, explanation: "Bu da gerçek çıktı! Bursalı bir aşçı almış eline satırı, Etiyopya'da bir kabileyi Adana kebabıyla tanıştırmış. Kabile o kadar beğenmiş ki, bizimkine 'enişte' demeye başlamışlar. Düşünsene, Etiyopya'da 'Enişte, bir Adana çek!' diyorlar.", displaySourceName: "Milliyet", displaySourceLink: "https://www.milliyet.com.tr/pembenar/etiyopyali-kabileye-kebabi-sevdiren-bursali-bana-herkes-burada-eniste-diyor-7368262", isSponsored: false, editorHint: "Bizim mutfağımızın namı dünyaya yayılmış durumda. Acaba bu haber de o sınırsız lezzet aşkının bir örneği olabilir mi?"},
{id: 3, title: "Muhtar, köyde yapay zekâ ile düğün organize etti: 'Davulcuya Gerek Kalmadı!'", snippet: "Çorum'un Bayat ilçesine bağlı bir köyde muhtar, köydeki genç çift için ChatGPT'den düğün organizasyonu planladı. Halay sırasını bile yapay zekâ belirledi.", image: "https://i.ibb.co/4RZqspXY/image.png", link: "#muhtar-chatgpt-dugun", isReal: false, explanation: "Yok artık, bu tamamen uydurma! Çorum'da muhtar ChatGPT'ye düğün planlatmış da, halay sırasını bile o belirlemiş falan... Kulağa komik geliyor ama maalesef (ya da neyse ki) böyle bir şey yaşanmamış. Sosyal medyada geyiği dönmüştür kesin, ama haber değeri yok, sallamasyon.", isSponsored: false, editorHint: "Yapay zeka hayatımızın her alanına giriyor ama bazı şeyler hala geleneksel kalmalı, değil mi? Özellikle davul zurnasız düğün olur mu?"},
{id: 4, title: "BYD'nin en büyüğü Tang tam tamına 7 kişilikmiş!", snippet: "Geniş İç Hacmi Görenleri Şaşırtan araca tam 7 kişilik bir aile rahatça sığabilen araç 'bu kadar da rahat olur mu?' dedirtiyor.", image: "https://i.ibb.co/mFSdLh8X/image.png", link: "^byd-tang", isReal: true, explanation: "Evet, bu haber gerçekten doğru! BYD'nin Tang modeli tam 7 koltuklu ve içi acayip geniş, yani büyük aileler ya da arkadaş grupları için süper rahat. Elektrikli olması, havalı tasarımı ve teknolojik sürüş özellikleriyle Tang, Türkiye'deki SUV'lara yeni bir soluk getiriyor. ", displaySourceName: "Hemen Keşfet!", displaySourceLink: "https://www.bydauto.com.tr/tang", isSponsored: true, editorHint: "Sponsorlu haberler genellikle ürünün bir özelliğini vurgular. Bu haberde de 'büyüklük' ve 'kişi sayısı' ön planda... Acaba gerçekten böyle bir model var mı?"},
{id: 5, title: "İstanbul'da yeni trafik uygulaması: Kornaya fazla basana ehliyet dondurma cezası!", snippet: "İBB'nin başlattığı pilot uygulamada, trafikte 3 saniyeden uzun süre korna çalan sürücülerin ehliyetine 1 hafta el konuluyor. Tepkiler karışık.", image: "https://i.ibb.co/RpB72wQm/image.png", link: "#korna-cezasi-kurgu", isReal: false, explanation: "Keşke gerçek olsa diyenler olabilir ama bu haber de maalesef gerçek değil. İstanbul trafiğinde kornaya abananın ehliyetine el koymak... Güzel fikir ama şimdilik sadece hayal. Olsa kimse şaşırmazdı o ayrı konu tabii, o kornalarla az çekmedik!", isSponsored: false, editorHint: "İstanbul trafiği ve korna... Kulağa mantıklı gelse de, böyle radikal bir uygulama hemen devreye girer miydi? Yoksa 'olsa güzel olurdu' dedirten bir hayal mi?"},
{id: 6, title: "Ankara'da 3+1 diye aldığı daire, 1+1 çıktı!", snippet: "Almanya’da yaşayan Mehmet Ü., Ankara’da 140 metrekare olarak satın aldığı dairenin aslında 78 metrekare ve 1+1 olduğunu fark edince şoke oldu. Konuyla ilgili dava açıldı.", image: "https://i.ibb.co/MxBPdvqN/image.png", link: "https://www.ensonhaber.com/3-sayfa/ankarada-31-diye-aldigi-daire-11-cikti", isReal: true, explanation: "Ah be Mehmet abi! Bu haber maalesef gerçek. Almanya'dan gelip Ankara'da 'Geniş geniş otururum' diye aldığı ev, kuş yuvası çıkmış resmen. 3+1 diye al, 1+1 çıksın... Tam 'Türkiye'de emlakçılık' fıkrası gibi ama yaşanmış. Basında da bayağı konuşuldu bu olay." , displaySourceName: "Hürriyet", displaySourceLink: "https://www.hurriyet.com.tr/gundem/4-yil-sonra-ogrendi-hayatinin-sokunu-yasadi-3-1-olarak-satin-aldigi-ev-1-1-cikti-42788236", isSponsored: false, editorHint: "Emlak piyasasında neler duyuyoruz neler... 'Olmaz olmaz' deme, bazen en olmayacak şeyler bile başa gelebiliyor. Dikkatli olmak lazım!"},
{id: 7, title: "Denizli Honaz Belediyesi, şehir sakinlerini uyanmak için yeni horoz uygulamasıyla tanıştırdı!", snippet: "Uykucu vatandaşlara doğal çözüm: Belediye, sabahları klasik alarm seslerinden şikayet edenler için 'horozlu uyandırma hizmeti' başlattı. Gerçek horozlar, belirlenen adreslere sabah 06.30’da götürülüyor.", image: "https://i.ibb.co/qQ9kDcB/image.png", link: "#horozlu-uyandirici", isReal: false, explanation: "Hahaha, bu çok iyiymiş ama tabii ki uydurma! Denizli'de belediye 'Alarmla uyanamayanlara horoz yolluyoruz' dese ortalık yıkılırdı herhalde. Sabahın köründe kapına horoz gelmesi... Mizah sitelerinde falan döner anca böyle şeyler, gerçek hayatta yok (şimdilik!).", isSponsored: false, editorHint: "Belediyelerin ilginç hizmetleri olabiliyor ama bu biraz fazla 'doğal' değil mi? Sabahın köründe horoz sesiyle uyanmak... Şehir efsanesi kokusu alıyorum!" },
{id: 8, title: "Sivaslı çiftçi, 9 deve kuşu alarak babasının hayalini gerçekleştirdi", snippet: "Sivas'ta yaşayan Berat Öksüz, babasının yıllar önceki deve kuşu besleme hayalini gerçekleştirdi. 'Bayağı şaşıran oluyor çünkü Sivas’ta görmedikleri bir şey' diyerek duygularını paylaştı.", image: "https://i.ibb.co/YTwYG3LT/image.png", link: "https://www.ensonhaber.com/3-sayfa/sivasli-ciftci-babasinin-hayalini-gerceklestirdi", isReal: true, explanation: "Bu da capcanlı gerçek! Sivaslı bir çiftçi, babasının 'Ah bir deve kuşu çiftliğim olsa' hayalini gerçekleştirmiş. Yiğidin harman olduğu yerde deve kuşu ne arar demeyin, Sivaslı şaşırtmayı sever. Adam yapmış valla, görenler de 'Vay be!' diyormuş.",displaySourceName: "En Son Haber", displaySourceLink: "https://www.ensonhaber.com/3-sayfa/sivasli-ciftci-babasinin-hayalini-gerceklestirdi", isSponsored: false, editorHint: "Anadolu'da girişimci ruhlar neler yapıyor neler! Bazen en beklenmedik yerlerde en ilginç işlere rastlayabiliyoruz. 'Yiğidin harman olduğu yer' klişesini bir düşün..." }
];

// Editör Bilgileri
const editors = [
    { name: "Can", icon: "https://i.ibb.co/P91BqYc/can.png", genericHints: [
        "Hmm, bu biraz şaibeli duruyor sanki... Ama bazen en inanılmaz şeyler gerçek çıkabiliyor, dikkatli ol!",
        "Bu haber tam 'Yok artık!' dedirten cinsten. Acaba gerçekten yaşanmış olabilir mi, yoksa birilerinin hayal gücü mü devrede?",
        "Sosyal medyada görsem direkt 'fake' derdim ama bazen hayat kurgudan daha garip olabiliyor. İyi düşün!"
    ]},
    { name: "Cenk", icon: "https://i.ibb.co/wSPc1fW/cenk.png", genericHints: [
        "Detaylara dikkat et. Haberdeki küçük bir ayrıntı gerçeği ele verebilir ya da tam tersi, seni yanıltabilir.",
        "Bu tür haberler genelde ya çok komik ya da çok şaşırtıcı olur. Acaba bu hangisi ve gerçeklik payı ne kadar?",
        "Benzer haberler daha önce çıktı mı diye bir düşün. Bazen aynı 'şaka' farklı versiyonlarla tekrar gündeme gelebiliyor."
    ]},
    { name: "Eylül", icon: "https://i.ibb.co/rGCNn0b2/image.png", genericHints: [
        "Kaynak önemli tabii ama bazen en güvenilir kaynaklar bile 'tıklanma' uğruna ilginç başlıklar atabiliyor. Acaba bu da onlardan mı?",
        "Olayın geçtiği yer ve zaman mantıklı mı? Bazı haberler sırf bu yüzden bile kendini ele verebilir.",
        "Eğer gerçekse kesin konuşulurdu, eğer sahteyse de iyi bir espri malzemesi olurdu. Sen ne dersin?"
    ]},
    { name: "Melis", icon: "https://i.ibb.co/YDBxHnn/melis.png", genericHints: [
        "Bu haberin bir benzerini daha önce duymuş gibi miyim? Yoksa tamamen orijinal bir 'vaka' mı söz konusu?",
        "İçindeki insan unsuruna odaklan. İnsanların yapabilecekleri bazen sınırsız olabiliyor, hem iyi hem de 'tuhaf' anlamda.",
        "Eğer bu sponsorlu bir içerik olsaydı, hangi mesajı vermeye çalışırdı? Bu açıdan düşünmek de bir ipucu olabilir."
    ]}
];
let currentEditorIndex = 0;
let hintUsedForCurrentQuestion = false;
let typingTimeout;


let currentQuestionIndex = 0; let score = 0; let currentStreak = 0;
let timerInterval; let timeLeft = 15; const TIME_PER_QUESTION = 15;
let gameStartTime;
let gamePlayedAtLeastOnce = JSON.parse(localStorage.getItem('fakeOrTakeGamePlayed_tr')) || false;

let isSwiping = false; let isMouseSwiping = false;
let swipeStartX = 0; let swipeCurrentX = 0;
const SWIPE_THRESHOLD = 70;
const CARD_MAX_ROTATION = 20;
const CARD_ROTATION_FACTOR = CARD_MAX_ROTATION / 160;
let animateInTimeoutId = null;
let timeUpAutoCloseTimeoutId = null;
let profilePopupTimeoutId = null;


function preloadImage(url) {
    const img = new Image();
    img.src = url;
    img.onload = () => { /* console.log(`Başarıyla ön yüklendi: ${url}`); */ };
    img.onerror = (err) => { console.warn(`Ön yükleme başarısız: ${url}`, err); };
}

function startPreloadingNewsImages() {
    newsData.forEach(newsItem => {
        if (newsItem.image && !newsItem.image.startsWith("data:image/")) {
            preloadImage(newsItem.image);
        }
    });
    editors.forEach(editor => {
        if (editor.icon) {
            preloadImage(editor.icon);
        }
    });
}


function saveGamePlayedState() { localStorage.setItem('fakeOrTakeGamePlayed_tr', JSON.stringify(gamePlayedAtLeastOnce)); }

function updateActiveNav(activeScreenId) {
    const navLinkElements = [
        homeNavHome, homeNavScores, homeNavProfile,
        gameNavHome, gameNavGame, gameNavScores
    ];

    navLinkElements.forEach(navEl => {
        if (navEl) {
            navEl.classList.remove('nav-item-active');
            const icon = navEl.querySelector('.nav-icon');
            if (icon && !icon.classList.contains('material-symbols-outlined')) {
                icon.classList.remove('material-icons');
                icon.classList.add('material-icons-outlined');
            }
        }
    });

    let elementsToActivate = [];
    const isHomeFooterVisible = homeNavHome && homeNavHome.offsetParent !== null;
    const isGameFooterVisible = gameNavGame && gameNavGame.offsetParent !== null;

    if (activeScreenId === 'homeScreen') {
        if (isHomeFooterVisible) elementsToActivate.push(homeNavHome);
        if (isGameFooterVisible) elementsToActivate.push(gameNavHome);
    } else if (activeScreenId === 'gameScreen') {
        if (isGameFooterVisible) elementsToActivate.push(gameNavGame);
    } else if (activeScreenId === 'resultsScreen') {
        if (isHomeFooterVisible) elementsToActivate.push(homeNavScores);
        if (isGameFooterVisible) elementsToActivate.push(gameNavScores);
        if (!isHomeFooterVisible && !isGameFooterVisible && resultsScreen && !resultsScreen.classList.contains('hidden')) {
             elementsToActivate.push(homeNavScores);
        }
    } else if (activeScreenId === 'profileScreen') {
        if (isHomeFooterVisible && homeNavProfile) elementsToActivate.push(homeNavProfile);
    }


    elementsToActivate.forEach(activeEl => {
        if (activeEl) {
            activeEl.classList.add('nav-item-active');
            const icon = activeEl.querySelector('.nav-icon');
            if (icon && !icon.classList.contains('material-symbols-outlined')) {
                icon.classList.remove('material-icons-outlined');
                icon.classList.add('material-icons');
            }
        }
    });
}


function showScreen(screen) {
    const allScreens = [homeScreenDiv, gameScreenDiv, feedbackScreen, resultsScreen];
    const allPopups = [timeUpPopup, modal, aboutModal, editorHintModal];
    allScreens.forEach(s => { if (s) { s.classList.add('hidden'); s.classList.remove('flex'); }});
    allPopups.forEach(p => { if (p) { p.classList.add('hidden'); p.classList.remove('flex'); }});

    if(screen){
        screen.classList.remove('hidden');
        if (allScreens.includes(screen) || allPopups.includes(screen)) { screen.classList.add('flex');}
        if (allScreens.includes(screen)) { updateActiveNav(screen.id); }
    } else {
        updateActiveNav(null);
    }
    if (!allPopups.includes(screen) && screen !== modal && screen !== aboutModal && screen !== editorHintModal) {
        window.scrollTo(0,0);
    }
}

function resetCardState(isNewCard = false) { if (!newsCard || !swipeRealIndicator || !swipeFakeIndicator) return; newsCard.classList.remove('fly-out-left', 'fly-out-right', 'enter-anim', 'active', 'swiping'); newsCard.style.animation = ''; if (isNewCard) { newsCard.classList.add('enter-anim'); newsCard.style.opacity = '0'; newsCard.style.transform = 'translateY(60px) scale(0.95) rotateX(-15deg)'; } else { newsCard.style.transition = 'transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1)'; newsCard.style.transform = 'translateX(0px) rotate(0deg)'; newsCard.style.opacity = '1'; newsCard.style.visibility = 'visible'; } swipeRealIndicator.classList.remove('visible'); swipeFakeIndicator.classList.remove('visible');}
function animateCardIn() { if (!newsCard) return; void newsCard.offsetWidth; newsCard.classList.add('active'); }

function updateUIForNewQuestion() {
    if (!newsCard || !newsImage || !newsTitle || !newsSnippet || !currentQuestionDisplay || !totalQuestionsDisplay || !progressBar || !streakCounter || !timerSeconds || !askEditorBtn || !askEditorBtnText) return;
    resetCardState(true);
    if (currentQuestionIndex >= newsData.length) {
        endGame();
        return;
    }
    const question = newsData[currentQuestionIndex];

    if (question.isSponsored) {
        newsCard.classList.add('sponsored-news-card');
    } else {
        newsCard.classList.remove('sponsored-news-card');
    }

    if (animateInTimeoutId) { clearTimeout(animateInTimeoutId); animateInTimeoutId = null; }
    if (newsImage) newsImage.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
    if (newsImage && question.image) {
        const img = new Image();
        img.onload = () => {
            newsImage.src = question.image;
            animateInTimeoutId = setTimeout(animateCardIn, 30);
        };
        img.onerror = () => {
            console.warn("Haber resmi yüklenemedi:", question.image);
            newsImage.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 4'%3E%3Crect width='100%' height='100%' fill='%23e2e8f0'/%3E%3Ctext x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='0.5px' fill='%2394a3b8'%3ENo Image%3C/text%3E%3C/svg%3E";
            animateInTimeoutId = setTimeout(animateCardIn, 30);
        };
        img.src = question.image;
    } else {
        newsImage.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3 4'%3E%3Crect width='100%' height='100%' fill='%23e2e8f0'/%3E%3Ctext x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='0.5px' fill='%2394a3b8'%3ENo Image%3C/text%3E%3C/svg%3E";
        animateInTimeoutId = setTimeout(animateCardIn, 30);
    }
    newsTitle.textContent = question.title;
    newsSnippet.textContent = question.snippet;
    currentQuestionDisplay.textContent = currentQuestionIndex + 1;
    totalQuestionsDisplay.textContent = newsData.length;
    streakCounter.textContent = currentStreak;
    progressBar.style.width = `${((currentQuestionIndex) / newsData.length) * 100}%`;
    timerSeconds.classList.remove('timer-pulse', 'text-red-500');
    if(timerMinutesBox) timerMinutesBox.classList.remove('timer-box-pulse');
    if(timerSecondsBox) timerSecondsBox.classList.remove('timer-box-pulse');

    hintUsedForCurrentQuestion = false;
    askEditorBtn.classList.remove('disabled');
    askEditorBtnText.textContent = "Editöre Sor";
    askEditorBtn.disabled = false;

}

function startTimer() {
    if(!timerSeconds || !timerMinutes || !timerMinutesBox || !timerSecondsBox) return;
    timeLeft = TIME_PER_QUESTION;
    timerSeconds.textContent = timeLeft < 10 ? `0${timeLeft}` : timeLeft;
    timerMinutes.textContent = "00";
    timerSeconds.classList.remove('timer-pulse', 'text-red-500');
    timerMinutesBox.classList.remove('timer-box-pulse');
    timerSecondsBox.classList.remove('timer-box-pulse');

    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
        timeLeft--;
        timerSeconds.textContent = timeLeft < 10 ? `0${timeLeft}` : timeLeft;

        if (timeLeft <= 3 && timeLeft > 0) {
            timerSeconds.classList.add('timer-pulse', 'text-red-500');
            timerMinutesBox.classList.add('timer-box-pulse');
            timerSecondsBox.classList.add('timer-box-pulse');
        } else if (timeLeft <= 5 && timeLeft > 0) {
             timerSeconds.classList.add('timer-pulse','text-red-500');
             timerMinutesBox.classList.remove('timer-box-pulse');
             timerSecondsBox.classList.remove('timer-box-pulse');
        }
        else {
            timerSeconds.classList.remove('timer-pulse', 'text-red-500');
            timerMinutesBox.classList.remove('timer-box-pulse');
            timerSecondsBox.classList.remove('timer-box-pulse');
        }
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            showTimeUpPopup();
        }
    }, 1000);
}

function showTimeUpPopup() {
    if (!timeUpPopup) return;
    timeUpPopup.classList.remove('hidden');
    timeUpPopup.classList.add('flex');
    if (timeUpAutoCloseTimeoutId) { clearTimeout(timeUpAutoCloseTimeoutId); }
    timeUpAutoCloseTimeoutId = setTimeout(() => {
        if (timeUpPopup && !timeUpPopup.classList.contains('hidden')) { handleAnswer(null); }
    }, 1200);
}

if (timeUpOkButton) {
    timeUpOkButton.addEventListener('click', () => {
        if (timeUpAutoCloseTimeoutId) { clearTimeout(timeUpAutoCloseTimeoutId); timeUpAutoCloseTimeoutId = null; }
        handleAnswer(null);
    });
}

function processSwipeDecision(isRealChoice) { if(!newsCard || !swipeRealIndicator || !swipeFakeIndicator) return; newsCard.style.transition = 'none'; if (isRealChoice) { newsCard.classList.add('fly-out-right'); swipeRealIndicator.classList.add('visible'); } else { newsCard.classList.add('fly-out-left'); swipeFakeIndicator.classList.add('visible'); } setTimeout(() => { handleAnswer(isRealChoice); }, 400); }

function handleAnswer(userChoiceIsReal) {
    if (!scoreDisplay || !feedbackTitleElement || !feedbackIcon || !feedbackBox || !feedbackText || !feedbackSourceSection || !feedbackSourceName || !feedbackSourceLinkTag || !streakCounter || !timerSeconds) return;
    clearInterval(timerInterval);
    if(timerSeconds) { timerSeconds.classList.remove('timer-pulse', 'text-red-500'); }
    if(timerMinutesBox) timerMinutesBox.classList.remove('timer-box-pulse');
    if(timerSecondsBox) timerSecondsBox.classList.remove('timer-box-pulse');

    if (timeUpAutoCloseTimeoutId) { clearTimeout(timeUpAutoCloseTimeoutId); timeUpAutoCloseTimeoutId = null; }
    if (timeUpPopup && !timeUpPopup.classList.contains('hidden')) { timeUpPopup.classList.add('hidden'); timeUpPopup.classList.remove('flex');}
    if (editorHintModal && !editorHintModal.classList.contains('hidden')) {
        editorHintModal.classList.add('hidden');
        editorHintModal.classList.remove('flex');
    }


    const currentQuestion = newsData[currentQuestionIndex];
    const wasCorrect = userChoiceIsReal === currentQuestion.isReal;

    if (userChoiceIsReal !== null && wasCorrect) { score++; currentStreak++;
    } else if (userChoiceIsReal !== null && !wasCorrect) { currentStreak = 0; }
    if(userChoiceIsReal === null) currentStreak = 0;

    scoreDisplay.textContent = score; streakCounter.textContent = currentStreak;
    feedbackIcon.className = "material-icons-outlined feedback-content-appear";
    feedbackBox.className = "rounded-lg bg-white p-5 sm:p-6 shadow-xl mb-6 sm:mb-8 feedback-content-appear";
    feedbackTitleElement.classList.add("feedback-content-appear");
    feedbackSourceSection.classList.add('hidden');
    let feedbackStr = "";

    if (userChoiceIsReal === null) {
        feedbackTitleElement.textContent = "Süre Bitti!"; feedbackIcon.textContent = "timer_off"; feedbackIcon.classList.add('timeup-icon'); feedbackBox.classList.add('incorrect-feedback');
feedbackStr = `Bu soru için süreniz doldu.<br>Doğru cevap: <strong>${currentQuestion.isReal ? 'GERÇEK' : 'SAHTE'}</strong><br><br>${currentQuestion.explanation || ''}`;
    } else if (wasCorrect) {
        feedbackTitleElement.textContent = "Bildin!"; feedbackIcon.textContent = "check_circle"; feedbackIcon.classList.add('status-icon-correct'); feedbackBox.classList.add('correct-feedback');
        feedbackStr = currentQuestion.explanation || (currentQuestion.isReal ? "Bu haber gerçekten doğru." : "Bu haberin sahte olduğunu doğru tespit ettin.");
    } else {
        feedbackTitleElement.textContent = "Tekrar dene!"; feedbackIcon.textContent = "cancel"; feedbackIcon.classList.add('status-icon-incorrect'); feedbackBox.classList.add('incorrect-feedback');
        feedbackStr = `Doğru cevap <strong>${currentQuestion.isReal ? 'GERÇEK' : 'SAHTE'}</strong> olmalıydı.<br><br>${currentQuestion.explanation || ''}`;
    }
    feedbackText.innerHTML = feedbackStr;
    if (currentQuestion.displaySourceName && currentQuestion.displaySourceLink) {
        feedbackSourceName.textContent = currentQuestion.displaySourceName; feedbackSourceLinkTag.href = currentQuestion.displaySourceLink; feedbackSourceSection.classList.remove('hidden');
    }
    feedbackNextButton.textContent = (currentQuestionIndex >= newsData.length - 1) ? "Sonuçları Gör" : "Sonraki Soru";
    showScreen(feedbackScreen);
}

function proceedToNextStep() { if (!progressBar) return; currentQuestionIndex++; progressBar.style.width = `${(currentQuestionIndex / newsData.length) * 100}%`; if (currentQuestionIndex < newsData.length) { showScreen(gameScreenDiv); updateUIForNewQuestion(); startTimer(); } else { endGame(); }}
if(feedbackNextButton) feedbackNextButton.addEventListener('click', proceedToNextStep);
if(closeFeedbackBtn) closeFeedbackBtn.addEventListener('click', proceedToNextStep);

function startGame() {
    if (!scoreDisplay || !totalQuestionsDisplay || !progressBar || !streakCounter) { console.error("Oyun başlatma için UI elementleri eksik"); return; }
    gameStartTime = Date.now();
    currentQuestionIndex = 0; score = 0; currentStreak = 0;
    scoreDisplay.textContent = score;
    streakCounter.textContent = currentStreak;
    totalQuestionsDisplay.textContent = newsData.length;
    progressBar.style.width = '0%';
    showScreen(gameScreenDiv);
    updateUIForNewQuestion();
    startTimer();
}

function populateLeaderboard() {
    if (!leaderboardEntriesContainer || !newsData || newsData.length === 0) return;
    leaderboardEntriesContainer.innerHTML = '';

    const botNamesAndPersonalities = [
        { name: "Fatih Mandalina", scoreMultiplier: 0.92 }, { name: "İsmail Büyükyaya", scoreMultiplier: 0.88 },
        { name: "Cüneyt Sazdemir", scoreMultiplier: 0.95 }, { name: "Nevşin Bambu", scoreMultiplier: 0.85 },
        { name: "Ahmet Haktan", scoreMultiplier: 0.78 }, { name: "Enver Taysever", scoreMultiplier: 0.90 },
        { name: "Ece Döner", scoreMultiplier: 0.82 }, { name: "Deniz Zeybek", scoreMultiplier: 0.75 },
        { name: "Yılmaz Özil", scoreMultiplier: 0.97 }, { name: "Fatih Ortaylı", scoreMultiplier: 0.80 }
    ];

    let botEntries = botNamesAndPersonalities.map(bot => ({
        name: bot.name,
        score: Math.min(newsData.length, Math.max(0, Math.floor(Math.random() * (newsData.length / 1.8) + (newsData.length * bot.scoreMultiplier * 0.45)))),
        isPlayer: false
    }));
    botEntries.sort(() => 0.5 - Math.random());
    const numBotsToBoost = Math.min(3, botEntries.length);
    for (let i = 0; i < numBotsToBoost; i++) {
        botEntries[i].score = Math.max(botEntries[i].score, Math.floor(newsData.length * (0.65 + Math.random() * 0.3)));
    }

    const playerScoreEntry = { name: "SEN", score: (gamePlayedAtLeastOnce ? score : 0), isPlayer: true };
    let allEntries = [...botEntries, playerScoreEntry];

    allEntries.sort((a, b) => {
        if (b.score === a.score) {
            if (a.isPlayer) return -1;
            if (b.isPlayer) return 1;
            return a.name.localeCompare(b.name);
        }
        return b.score - a.score;
    });

    const maxEntriesToShow = 7;
    let displayEntries = [];

    if (allEntries.length <= maxEntriesToShow) {
        displayEntries = [...allEntries];
    } else {
        const playerRankGlobal = allEntries.findIndex(entry => entry.isPlayer);
        if (playerRankGlobal < maxEntriesToShow -1 ) {
            displayEntries = allEntries.slice(0, maxEntriesToShow);
        } else {
            displayEntries = allEntries.slice(0, maxEntriesToShow - 2);
            displayEntries.push({ name: "...", score: -1, isPlayer: false, isEllipsis: true });
            if (!displayEntries.some(e=> e.isPlayer && e.name === playerScoreEntry.name)) {
                 displayEntries.push(playerScoreEntry);
            }
        }
        if (displayEntries.some(e => e.isEllipsis) && displayEntries.findIndex(e => e.isPlayer) === displayEntries.findIndex(e => e.isEllipsis) -1 ) {
            displayEntries = displayEntries.filter(e => !e.isEllipsis);
            if(displayEntries.length < maxEntriesToShow && allEntries.length > maxEntriesToShow) {
                const nextEntry = allEntries.find(ae => !displayEntries.some(de => de.name === ae.name && de.score === ae.score));
                if(nextEntry) displayEntries.push(nextEntry);
            }
        }
    }
     displayEntries.sort((a, b) => {
        if(a.isEllipsis) return 1;
        if(b.isEllipsis) return -1;
        if (b.score === a.score) {
            if (a.isPlayer) return -1;
            if (b.isPlayer) return 1;
            return a.name.localeCompare(b.name);
        }
        return b.score - a.score;
    });
    if (displayEntries.length > maxEntriesToShow) {
        const playerInDisplay = displayEntries.some(e => e.isPlayer);
        if (playerInDisplay && displayEntries.findIndex(e => e.isPlayer) >= maxEntriesToShow -1) {
             let tempEntries = displayEntries.slice(0, maxEntriesToShow -1);
             if (!tempEntries.some(e=>e.isPlayer)) tempEntries.push(playerScoreEntry);
             displayEntries = tempEntries;
             displayEntries.sort((a, b) => { if (b.score === a.score) { if (a.isPlayer) return -1; if (b.isPlayer) return 1; return a.name.localeCompare(b.name); } return b.score - a.score; });
        } else {
            displayEntries = displayEntries.slice(0, maxEntriesToShow);
        }
    }


    displayEntries.forEach((entry) => {
        const entryDiv = document.createElement('div');
        entryDiv.className = 'flex items-center justify-between rounded-lg p-4 transition-all text-sm sm:text-base shadow-sm';

        if(entry.isEllipsis) {
            entryDiv.innerHTML = `<p class="text-center w-full text-slate-500 text-xs">...</p>`;
            leaderboardEntriesContainer.appendChild(entryDiv);
            return;
        }

        const leftPart = document.createElement('div');
        leftPart.className = 'flex items-center gap-3';

        const rankDisplaySpan = document.createElement('span');
        const actualRank = allEntries.findIndex(e => e.name === entry.name && e.score === entry.score && e.isPlayer === entry.isPlayer) + 1;
        let rankText = `${actualRank}.`;
        let rankIconClass = 'text-slate-600';

        if (actualRank === 1) { rankText = '🥇'; rankIconClass = 'text-amber-400';}
        else if (actualRank === 2) { rankText = '🥈'; rankIconClass = 'text-slate-400';}
        else if (actualRank === 3) { rankText = '🥉'; rankIconClass = 'text-orange-400';}


        if (entry.isPlayer) {
            entryDiv.classList.add('bg-indigo-100', 'text-indigo-700', 'ring-2', 'ring-offset-2', 'ring-offset-indigo-100', 'ring-indigo-500', 'shadow-md');
            rankDisplaySpan.className = `text-xl font-semibold ${rankIconClass}`;
            rankDisplaySpan.innerHTML = `${(actualRank > 3) ? '★ ' : ''}${rankText}`;
        } else {
            entryDiv.classList.add('bg-slate-100', 'hover:bg-slate-200/80');
            rankDisplaySpan.className = `text-lg sm:text-xl font-semibold ${actualRank <=3 ? rankIconClass : 'text-slate-600'}`;
            rankDisplaySpan.innerHTML = rankText;
        }
        leftPart.appendChild(rankDisplaySpan);

        const nameP = document.createElement('p');
        nameP.className = `font-medium ${entry.isPlayer ? 'text-indigo-800' : 'text-slate-700'}`;
        nameP.textContent = entry.name;
        leftPart.appendChild(nameP);

        const scoreP = document.createElement('p');
        scoreP.className = `font-semibold ${entry.isPlayer ? 'text-indigo-800' : 'text-slate-700'}`;
        scoreP.textContent = `${entry.score}/${newsData.length}`;

        entryDiv.appendChild(leftPart);
        entryDiv.appendChild(scoreP);
        leaderboardEntriesContainer.appendChild(entryDiv);
    });
}


function endGame() {
    if (!timeTakenValue || !finalScoreValue || !highScoreDisplay) return;
    gamePlayedAtLeastOnce = true;
    saveGamePlayedState();
    clearInterval(timerInterval);
    if(timerSeconds) { timerSeconds.classList.remove('timer-pulse', 'text-red-500'); }
    if(timerMinutesBox) timerMinutesBox.classList.remove('timer-box-pulse');
    if(timerSecondsBox) timerSecondsBox.classList.remove('timer-box-pulse');

    const gameEndTimeVariable = Date.now();
    const timeDiff = gameEndTimeVariable - (gameStartTime || gameEndTimeVariable) ;
    const mins = Math.floor(timeDiff / 60000); const secs = Math.floor((timeDiff % 60000) / 1000);

    if (timeTakenValue) timeTakenValue.textContent = `${mins} dakika ${secs} saniye`;
    if (finalScoreValue) finalScoreValue.textContent = `${score}/${newsData.length}`;

    let hs = parseInt(localStorage.getItem('fakeOrTakeHighScore_tr')) || 0;
    if (score > hs) { hs = score; localStorage.setItem('fakeOrTakeHighScore_tr', hs); }
    if (highScoreDisplay) highScoreDisplay.textContent = `${hs}/${newsData.length}`;

    populateLeaderboard();
    showScreen(resultsScreen);
}

function resetGame() {
    clearInterval(timerInterval);
    if(timerSeconds) { timerSeconds.classList.remove('timer-pulse', 'text-red-500'); }
    if(timerMinutesBox) timerMinutesBox.classList.remove('timer-box-pulse');
    if(timerSecondsBox) timerSecondsBox.classList.remove('timer-box-pulse');
    if (editorHintModal && !editorHintModal.classList.contains('hidden')) {
        editorHintModal.classList.add('hidden');
        editorHintModal.classList.remove('flex');
    }
    if (askEditorBtn && askEditorBtnText) {
        hintUsedForCurrentQuestion = false;
        askEditorBtn.classList.remove('disabled');
        askEditorBtnText.textContent = "Editöre Sor";
        askEditorBtn.disabled = false;
    }
}
function navigateToHome() { resetGame(); showScreen(homeScreenDiv); }

function navigateToResults() {
    resetGame();
    if (!gamePlayedAtLeastOnce) {
        if (finalScoreValue) finalScoreValue.textContent = "0/0";
        if (timeTakenValue) timeTakenValue.textContent = "-";
        let hs = parseInt(localStorage.getItem('fakeOrTakeHighScore_tr')) || 0;
        let totalQDisplay = newsData && newsData.length > 0 ? newsData.length : "X";
        if (highScoreDisplay) highScoreDisplay.textContent = `${hs}/${totalQDisplay}`;
    } else {
        if (finalScoreValue) finalScoreValue.textContent = `${score}/${newsData.length}`;
        let hs = parseInt(localStorage.getItem('fakeOrTakeHighScore_tr')) || 0;
        if (highScoreDisplay) highScoreDisplay.textContent = `${hs}/${newsData.length}`;
    }
    populateLeaderboard();
    showScreen(resultsScreen);
}


function unifiedSwipeStart(e) {
    if (!newsCard || newsCard.classList.contains('fly-out-left') || newsCard.classList.contains('fly-out-right')) return;
    if (animateInTimeoutId) { clearTimeout(animateInTimeoutId); animateInTimeoutId = null; }
    if (newsCard.classList.contains('enter-anim') || (newsCard.style.animation && newsCard.style.animation !== 'none')) {
        newsCard.classList.remove('enter-anim', 'active');
        newsCard.style.animation = 'none';
        newsCard.style.visibility = 'visible';
    }
    newsCard.style.opacity = '1'; newsCard.style.transform = '';
    isSwiping = true; isMouseSwiping = (e.type === 'mousedown');
    swipeStartX = isMouseSwiping ? e.pageX : e.touches[0].pageX;
    newsCard.style.transition = 'none'; newsCard.classList.add('swiping');
    if (isMouseSwiping) { document.addEventListener('mousemove', unifiedSwipeMove); document.addEventListener('mouseup', unifiedSwipeEnd); }
}
function unifiedSwipeMove(e) {
    if (!isSwiping || !newsCard) return;
    swipeCurrentX = isMouseSwiping ? e.pageX : e.touches[0].pageX; let diffX = swipeCurrentX - swipeStartX;
    if (e.type === 'touchmove' && Math.abs(diffX) > 5 && e.cancelable) { e.preventDefault(); }
    let rotation = diffX * CARD_ROTATION_FACTOR; rotation = Math.max(-CARD_MAX_ROTATION, Math.min(CARD_MAX_ROTATION, rotation));
    const newTransform = `translateX(${diffX}px) rotate(${rotation}deg)`;
    requestAnimationFrame(() => { if (isSwiping) { newsCard.style.transform = newTransform; } });
    if (diffX > SWIPE_THRESHOLD / 1.8) { swipeRealIndicator.classList.add('visible'); swipeFakeIndicator.classList.remove('visible');
    } else if (diffX < -SWIPE_THRESHOLD / 1.8) { swipeFakeIndicator.classList.add('visible'); swipeRealIndicator.classList.remove('visible');
    } else { swipeRealIndicator.classList.remove('visible'); swipeFakeIndicator.classList.remove('visible'); }
}
function unifiedSwipeEnd(e) {
    if (!isSwiping || !newsCard) return;
    if (isMouseSwiping) { document.removeEventListener('mousemove', unifiedSwipeMove); document.removeEventListener('mouseup', unifiedSwipeEnd); }
    isSwiping = false; isMouseSwiping = false; newsCard.classList.remove('swiping');
    let diffX = swipeCurrentX - swipeStartX;
    if (Math.abs(diffX) > SWIPE_THRESHOLD) {
        if (diffX > 0) { swipeRealIndicator.classList.add('visible'); } else { swipeFakeIndicator.classList.add('visible'); }
        processSwipeDecision(diffX > 0);
    } else {
        resetCardState(false);
    }
    swipeStartX = 0; swipeCurrentX = 0;
}
if (newsCard) {
    newsCard.addEventListener('mousedown', unifiedSwipeStart);
    newsCard.addEventListener('touchstart', unifiedSwipeStart, { passive: true });
    newsCard.addEventListener('touchmove', unifiedSwipeMove, { passive: false });
    newsCard.addEventListener('touchend', unifiedSwipeEnd);
    newsCard.addEventListener('touchcancel', unifiedSwipeEnd);
} else { console.error("Haber kartı (newsCard) DOM'da bulunamadı! Swipe çalışmayacak."); }

async function handleShareResults() {
    if (!newsData || newsData.length === 0) { alert("Paylaşılacak bir sonuç bulunamadı."); return; }
    const currentScoreForShare = gamePlayedAtLeastOnce ? score : 0;
    const shareText = `FakeBreak'de ${currentScoreForShare}/${newsData.length} yaptım! Sen de bu haberlerin gerçek mi sahte mi olduğunu tahmin etmeye çalış. Challenge'a var mısın? 😎`;
    const shareUrl = window.location.href; const shareTitle = "FakeBreak - Skor Yarışması!";
    if (navigator.share) {
        try { await navigator.share({ title: shareTitle, text: shareText, url: shareUrl }); console.log('Sonuç başarıyla paylaşıldı!'); }
        catch (error) { console.error('Paylaşım sırasında hata oluştu:', error); if (error.name !== 'AbortError') { alert('Paylaşım sırasında bir hata oluştu.');} }
    } else {
        try { await navigator.clipboard.writeText(`${shareTitle}\n${shareText}\n${shareUrl}`); alert('Paylaşım özelliği bu tarayıcıda desteklenmiyor. Skorun ve davet mesajın panoya kopyalandı, istediğin yerde paylaşabilirsin!'); }
        catch (err) { alert('Paylaşım özelliği bu tarayıcıda desteklenmiyor ve metin panoya kopyalanamadı. Lütfen skoru manuel olarak paylaşın.'); console.error('Panoya kopyalama başarısız:', err); }
    }
}

if (howToPlayButton && modal && closeModalButton) {
    const openHowToPlayModal = () => { if (modal) { modal.classList.remove('hidden'); modal.classList.add('flex'); } };
    const closeHowToPlayModal = () => { if (modal) { modal.classList.add('hidden'); modal.classList.remove('flex'); } };
    howToPlayButton.addEventListener('click', openHowToPlayModal);
    closeModalButton.addEventListener('click', closeHowToPlayModal);
    modal.addEventListener('click', (event) => { if (event.target === modal) { closeHowToPlayModal(); } });
} else { console.error("Modal ('Nasıl Oynanır') elementleri bulunamadı."); }

if (aboutBtn && aboutModal && closeAboutModalBtn) {
    const openAboutModal = () => { if (aboutModal) { aboutModal.classList.remove('hidden'); aboutModal.classList.add('flex'); } };
    const closeAboutModal = () => { if (aboutModal) { aboutModal.classList.add('hidden'); aboutModal.classList.remove('flex'); } };
    aboutBtn.addEventListener('click', openAboutModal);
    closeAboutModalBtn.addEventListener('click', closeAboutModal);
    aboutModal.addEventListener('click', (event) => { if (event.target === aboutModal) { closeAboutModal(); } });
} else { console.error("Hakkında Modal elementleri bulunamadı."); }

if (homeNavProfile && profileDisabledPopup) {
    homeNavProfile.addEventListener('click', (e) => {
        e.preventDefault();
        if (profilePopupTimeoutId) { clearTimeout(profilePopupTimeoutId); }
        profileDisabledPopup.classList.remove('opacity-0', 'pointer-events-none');
        profileDisabledPopup.classList.add('opacity-100');
        profilePopupTimeoutId = setTimeout(() => {
            profileDisabledPopup.classList.remove('opacity-100');
            profileDisabledPopup.classList.add('opacity-0');
            setTimeout(() => {
                if (!profileDisabledPopup.classList.contains('opacity-100')) {
                    profileDisabledPopup.classList.add('pointer-events-none');
                }
            }, 300);
            profilePopupTimeoutId = null;
        }, 2500);
    });
}

function typeWriter(text, i, speed = 25) {
    if (i < text.length) {
        editorQuote.innerHTML = text.substring(0, i + 1);
        editorQuote.classList.remove('typing-done');
        typingTimeout = setTimeout(() => typeWriter(text, i + 1, speed), speed);
    } else {
        editorQuote.classList.add('typing-done');
    }
}

function showEditorHint() {
    if (hintUsedForCurrentQuestion || currentQuestionIndex >= newsData.length) return;

    const currentQuestionData = newsData[currentQuestionIndex];
    const editor = editors[currentEditorIndex % editors.length];
    let hintText = currentQuestionData.editorHint || editor.genericHints[Math.floor(Math.random() * editor.genericHints.length)];

    editorIcon.src = editor.icon || "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
    editorName.textContent = editor.name;

    if (typingTimeout) clearTimeout(typingTimeout);
    editorQuote.innerHTML = "";
    editorQuote.classList.remove('typing-done');

    typeWriter(hintText, 0);

    editorHintModal.classList.remove('hidden');
    editorHintModal.classList.add('flex');

    hintUsedForCurrentQuestion = true;
    askEditorBtn.classList.add('disabled');
    askEditorBtnText.textContent = "Editör Meşgul!";
    askEditorBtn.disabled = true;

    currentEditorIndex++;
}

if (askEditorBtn) {
    askEditorBtn.addEventListener('click', showEditorHint);
}
if (closeEditorHintBtn) {
    closeEditorHintBtn.addEventListener('click', () => {
        editorHintModal.classList.add('hidden');
        editorHintModal.classList.remove('flex');
        if (typingTimeout) clearTimeout(typingTimeout);
        editorQuote.classList.add('typing-done');
    });
}
if (editorHintModal) {
    editorHintModal.addEventListener('click', (event) => {
        if (event.target === editorHintModal) {
            editorHintModal.classList.add('hidden');
            editorHintModal.classList.remove('flex');
             if (typingTimeout) clearTimeout(typingTimeout);
             editorQuote.classList.add('typing-done');
        }
    });
}


if (playNowButton) { playNowButton.addEventListener('click', startGame); }
if (closeGameButton) { closeGameButton.addEventListener('click', navigateToHome); }
if(shareResultsBtn) shareResultsBtn.addEventListener('click', handleShareResults);
if(playAgainBtn) playAgainBtn.addEventListener('click', startGame);
if(backToHomeResultsBtn) backToHomeResultsBtn.addEventListener('click', navigateToHome);
if(closeResultsHeaderBtn) closeResultsHeaderBtn.addEventListener('click', navigateToHome);

[homeNavHome, gameNavHome].forEach(el => el?.addEventListener('click', (e) => { e.preventDefault(); navigateToHome(); }));
[homeNavScores, gameNavScores, leaderboardBtnHome].forEach(el => el?.addEventListener('click', (e) => { e.preventDefault(); navigateToResults(); }));


if (!gamePlayedAtLeastOnce) {
    if (finalScoreValue) finalScoreValue.textContent = "0/0";
    if (timeTakenValue) timeTakenValue.textContent = "-";
    let hs = parseInt(localStorage.getItem('fakeOrTakeHighScore_tr')) || 0;
    let totalQDisplay = newsData && newsData.length > 0 ? newsData.length : "X";
    if (highScoreDisplay) highScoreDisplay.textContent = `${hs}/${totalQDisplay}`;
}

showScreen(homeScreenDiv);
if(document.body) document.body.classList.remove('loading');

if (newsData && newsData.length > 0) {
    startPreloadingNewsImages();
}

});
</script>
</body>
</html>
